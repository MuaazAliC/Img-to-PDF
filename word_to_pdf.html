<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DOCX to PDF Converter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/MuaazAliC/Internship-Projects/refs/heads/main/6th/img/pf.png" type="image/x-icon">
  <style>
:root {
  --bg1:#0f172a; --bg2:#1e293b; --bg3:#3b82f6; --muted:#94a3b8; --card:rgba(15,23,42,.75);
  --ring: rgba(59,130,246,.6); --accent:#60a5fa; --accent-2:#38bdf8; --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

html, body { height: 100%; }

body {
  font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  color: #e5e7eb;
  background: linear-gradient(135deg, var(--bg1), var(--bg2), #0ea5e9 120%);
  background-size: 300% 300%;
  animation: bgflow 18s ease-in-out infinite;
  display: flex;
  flex-direction: column;
}

@keyframes bgflow {
  0% { background-position: 0% 50% }
  50% { background-position: 100% 50% }
  100% { background-position: 0% 50% }
}

.container {
  max-width: 1100px;
  margin: 32px auto;
  padding: 0 16px;
  flex: 1; /* keeps footer at bottom */
}

header {
  display: flex;
  gap: 16px;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.title {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
}

.badge {
  font-size: 12px;
  padding: 4px 10px;
  border-radius: 999px;
  background: rgba(148,163,184,.15);
  color: #cbd5e1;
}

h1 {
  font-size: clamp(22px, 3.5vw, 32px);
  font-weight: 700;
}

/* Cards */
.card {
  background: var(--card);
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 20px;
  padding: 18px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
}

/* Grid */
.grid {
  display: grid;
  grid-template-columns: 1.2fr .8fr;
  gap: 18px;
}
@media (max-width: 950px) {
  .grid { grid-template-columns: 1fr; }
}

/* Navbar */
nav {
  background: rgba(30, 41, 59, 0.7);
  backdrop-filter: blur(10px);
  color: #fff;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  position: sticky;
  top: 0;
  width: 100%;
  z-index: 1000;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

nav .logo {
  font-size: 24px;
  font-weight: 700;
  color: #38bdf8;
  transition: 0.3s;
  white-space: nowrap;
}
nav .logo:hover { color: #60a5fa; }

nav ul {
  list-style: none;
  display: flex;
  gap: 25px;
}
nav ul li a {
  text-decoration: none;
  color: #e2e8f0;
  font-size: 16px;
  transition: 0.3s ease;
  padding: 6px 10px;
  border-radius: 8px;
}
nav ul li a:hover {
  background: rgba(56, 189, 248, 0.15);
  color: #38bdf8;
}

/* Hamburger */
.menu-toggle {
  display: none;
  flex-direction: column;
  cursor: pointer;
  gap: 5px;
}
.menu-toggle span {
  width: 25px;
  height: 3px;
  background: #fff;
  border-radius: 2px;
}

@media (max-width: 768px) {
  nav {
    flex-wrap: wrap;
    padding: 12px 16px;
  }
  nav ul {
    display: none;
    flex-direction: column;
    background: rgba(30, 41, 59, 0.95);
    position: absolute;
    top: 60px;
    right: 5%;
    padding: 20px;
    width: 90%;
    border-radius: 8px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  }
  nav ul.active { display: flex; }
  .menu-toggle { display: flex; margin-left: auto; }
}

/* Dropzone */
.drop {
  border: 2px dashed rgba(148,163,184,.35);
  border-radius: 18px;
  padding: 20px;
  text-align: center;
  transition: .25s;
  background: linear-gradient(180deg, rgba(148,163,184,.08), rgba(148,163,184,.03));
}
.drop.dragover {
  border-color: var(--accent);
  box-shadow: 0 0 0 6px rgba(96,165,250,.12);
}
.drop h3 { margin: 8px 0 6px; font-weight: 600; }
.drop p { margin: 0; color: var(--muted); }

.actions {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  margin-top: 14px;
}

.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(59,130,246,.18), rgba(59,130,246,.08));
  color: white;
  cursor: pointer;
  font-weight: 600;
  box-shadow: 0 6px 18px rgba(59,130,246,.25);
  transition: transform .08s ease, box-shadow .2s ease;
  text-decoration: none;
}
.btn:hover { transform: translateY(-1px); }
.btn.secondary { background: rgba(148,163,184,.15); box-shadow: none; }

input[type="file"] { display: none; }

/* Options */
.options {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}
@media (max-width: 600px) {
  .options { grid-template-columns: 1fr; }
}
.field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.field label {
  font-size: 12px;
  color: #cbd5e1;
}
.field input, .field select {
  background: rgba(148,163,184,.12);
  border: 1px solid rgba(255,255,255,.08);
  color: #e5e7eb;
  border-radius: 12px;
  padding: 10px 12px;
  outline: none;
  transition: box-shadow .15s ease, border-color .15s ease;
}
.field input:focus, .field select:focus {
  box-shadow: 0 0 0 4px var(--ring);
  border-color: rgba(96,165,250,.65);
}

/* Preview */
.preview-wrap {
  background: #0b1220;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.08);
  overflow: hidden;
}
.toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  background: rgba(148,163,184,.08);
}
.toolbar .left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.pill {
  padding: 6px 10px;
  font-size: 12px;
  border-radius: 999px;
  background: rgba(148,163,184,.15);
}
#status { font-size: 12px; color: #cbd5e1; }

#preview {
  height: 520px;
  overflow: auto;
  padding: 24px;
  background: #ffffff;
  color: #111827;
}
@media (max-width: 600px) {
  #preview { height: 350px; padding: 14px; font-size: 14px; }
}

/* Mammoth content default styles */
#preview h1, #preview h2, #preview h3 { margin: .6em 0 .4em; line-height: 1.2; }
#preview p { margin: .45em 0; }
#preview table {
  border-collapse: collapse;
  width: 100%;
  margin: .5em 0;
}
#preview table, #preview th, #preview td { border: 1px solid #d1d5db; }
#preview th, #preview td { padding: .5em; }
#preview img { max-width: 100%; height: auto; }

/* Footer */
footer {
  background: #1e293b;
  color: #cbd5e1;
  text-align: center;
  padding: 20px 10px;
  width: 100%;
  border-top: 1px solid rgba(255,255,255,0.1);
  flex-shrink: 0;
}
footer .social-links { margin-bottom: 15px; display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; }
footer .social-links a {
  color: #cbd5e1;
  font-size: 22px;
  transition: 0.3s;
}
footer .social-links a:hover {
  color: #38bdf8;
  transform: scale(1.2);
}
footer p { font-size: 14px; opacity: 0.8; }


  </style>
</head>
<body>
     <nav>
    <div class="logo">Code With Muaaz</div>
    <ul id="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="index.html">Tools</a></li>
      <li><a href="#footer">Contact</a></li>
    </ul>
    
    <div class="menu-toggle" onclick="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </nav>
  <div class="container">
    <header>
      <div class="title">
        <i class="fa-solid fa-file-word" style="font-size:28px"></i>
        <div>
          <h1>DOCX → PDF Converter</h1>
          <div class="badge">Runs 100% in your browser – no upload</div>
        </div>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT: Upload + Options -->
      <div class="card">
        <div id="drop" class="drop">
          <i class="fa-solid fa-cloud-arrow-up" style="font-size:34px"></i>
          <h3>Drop a .docx file here</h3>
          <p>or</p>
          <div class="actions">
            <label class="btn" for="file"><i class="fa-solid fa-upload"></i> Choose .docx</label>
            <button class="btn secondary" id="convertBtn" disabled><i class="fa-solid fa-file-pdf"></i> Convert to PDF</button>
          </div>
          <input id="file" type="file" accept=".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document" />
        </div>

        <div style="margin-top:16px; display:grid; gap:12px">
          <div class="options">
            <div class="field">
              <label for="filename">Output file name</label>
              <input id="filename" type="text" placeholder="my-document.pdf" value="converted.pdf" />
            </div>
            <div class="field">
              <label for="format">Page size</label>
              <select id="format">
                <option value="a4" selected>A4</option>
                <option value="letter">US Letter</option>
                <option value="a3">A3</option>
              </select>
            </div>
            <div class="field">
              <label for="orientation">Orientation</label>
              <select id="orientation">
                <option value="portrait" selected>Portrait</option>
                <option value="landscape">Landscape</option>
              </select>
            </div>
            <div class="field">
              <label for="margin">Margins (mm)</label>
              <input id="margin" type="number" min="0" step="1" value="15" />
            </div>
          </div>
          <div style="display:flex; gap:10px; align-items:center; color:#cbd5e1">
            <i class="fa-solid fa-circle-info"></i>
            <small>Supports <strong>.docx</strong> files. Complex layouts (headers/footers, columns) may simplify.
            For best results, export your Word file to .docx (not .doc).</small>
          </div>
        </div>
      </div>

      <!-- RIGHT: Preview -->
      <div class="card preview-wrap">
        <div class="toolbar">
          <div class="left">
            <span class="pill" id="filepill"><i class="fa-regular fa-file-word"></i> No file</span>
            <span class="pill" id="sizepill">0 KB</span>
          </div>
          <span id="status">Waiting for file…</span>
        </div>
        <div id="preview"> 
          <p style="color:#6b7280">Your document preview will appear here after loading a .docx file.</p>
        </div>
      </div>
    </div>

   
  </div>
<footer id="footer">
    <div class="social-links">
      <a href="https://www.youtube.com/@CodeWithMuaaz-official" target="_blank"><i class="fab fa-youtube"></i></a>
      <a href="https://github.com/MuhammadMuaazAli" target="_blank"><i class="fab fa-github"></i></a>
      <a href="https://www.instagram.com/codewithmuaaz" target="_blank"><i class="fab fa-instagram"></i></a>
      <a href="https://www.linkedin.com/in/muhammad-muaaz-ali-6373ab2a3/" target="_blank"><i class="fab fa-linkedin"></i></a>
      <a href="https://muhammadmuaazali.github.io/website/" target="_blank"><i class="fas fa-globe"></i></a>
    </div><p class="footer-text">✨ 100% client-side — your files never leave your device.  
  Your privacy is our first priority. ✨</p>
    <p>© 2025 Muhammad Muaaz Ali. All rights reserved.</p>
  </footer>

  <!-- Libraries -->
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <script>
    function toggleMenu() {
  document.getElementById("nav-links").classList.toggle("active");
}

// === CLOSE NAVBAR ON OUTSIDE CLICK ===
document.addEventListener("click", function (event) {
  const nav = document.getElementById("nav-links");
  const toggleBtn = document.querySelector(".menu-toggle"); // your hamburger button

  if (
    nav.classList.contains("active") && 
    !nav.contains(event.target) && 
    !toggleBtn.contains(event.target)
  ) {
    nav.classList.remove("active");
  }
});

// === CLOSE NAVBAR WHEN LINK CLICKED ===
document.querySelectorAll("#nav-links a").forEach(link => {
  link.addEventListener("click", () => {
    document.getElementById("nav-links").classList.remove("active");
  });
});

// === SEARCH LOGIC ===
const searchInput = document.getElementById("searchInput");
const toolCards = document.querySelectorAll(".tool-card");

searchInput.addEventListener("keyup", function () {
  const filter = searchInput.value.toLowerCase().trim();
  toolCards.forEach(card => {
    const toolName = card.dataset.name.toLowerCase();
    if (toolName.includes(filter)) {
      card.parentElement.style.display = "block"; // Show card
    } else {
      card.parentElement.style.display = "none"; // Hide card
    }
  });
});
    const drop = document.getElementById('drop');
    const fileInput = document.getElementById('file');
    const preview = document.getElementById('preview');
    const statusEl = document.getElementById('status');
    const convertBtn = document.getElementById('convertBtn');
    const filepill = document.getElementById('filepill');
    const sizepill = document.getElementById('sizepill');
    const filenameEl = document.getElementById('filename');
    const formatEl = document.getElementById('format');
    const orientationEl = document.getElementById('orientation');
    const marginEl = document.getElementById('margin');

    let lastHtml = '';

    // Drag & drop
    ['dragenter','dragover'].forEach(evt => drop.addEventListener(evt, e=>{e.preventDefault(); e.stopPropagation(); drop.classList.add('dragover');}))
    ;['dragleave','drop'].forEach(evt => drop.addEventListener(evt, e=>{e.preventDefault(); e.stopPropagation(); drop.classList.remove('dragover');}))
    drop.addEventListener('drop', e=>{
      const files = e.dataTransfer.files;
      if(files && files[0]) handleFile(files[0]);
    });

    // File input
    fileInput.addEventListener('change', e=>{
      const f = e.target.files?.[0];
      if(f) handleFile(f);
    });

    function niceSize(bytes){
      if(!bytes && bytes !== 0) return '0 KB';
      const units=['B','KB','MB','GB']; let i=0; let n=bytes;
      while(n>=1024 && i<units.length-1){n/=1024; i++}
      return `${n.toFixed( (i===0)?0:1)} ${units[i]}`
    }

    async function handleFile(file){
      if(!/\.docx$/i.test(file.name)){
        toast('Please select a .docx file', 'err');
        return;
      }
      setStatus('Reading file…');
      filepill.innerHTML = `<i class="fa-regular fa-file-word"></i> ${file.name}`;
      sizepill.textContent = niceSize(file.size);

      const reader = new FileReader();
      reader.onerror = ()=> toast('Could not read the file', 'err');
      reader.onload = async (evt)=>{
        try{
          setStatus('Converting DOCX to HTML…');
          const arrayBuffer = evt.target.result;
          const options = {
            styleMap: [
              // Better defaults for headings/lists
              "p[style-name='Title'] => h1:fresh",
              "p[style-name='Subtitle'] => h2:fresh",
            ],
            convertImage: mammoth.images.inline(async element => {
              const data = await element.read("base64");
              return { src: `data:${element.contentType};base64,${data}` };
            })
          };

          const result = await mammoth.convertToHtml({ arrayBuffer }, options);
          lastHtml = result.value;

          // Warnings from Mammoth
          if(result.messages?.length){
            console.warn('Mammoth messages:', result.messages);
          }

          // Render into preview
          preview.innerHTML = lastHtml || '<p>(Empty document)</p>';
          setStatus('Ready. Click “Convert to PDF”.');
          convertBtn.disabled = false;
          // Suggest an output name
          const base = file.name.replace(/\.docx$/i, '');
          if(!filenameEl.value || filenameEl.value === 'converted.pdf') filenameEl.value = base + '.pdf';
        }catch(err){
          console.error(err);
          toast('Failed to convert DOCX. (Some complex layouts may not be supported.)', 'err');
          setStatus('Error. Try another file.');
          convertBtn.disabled = true;
        }
      };
      reader.readAsArrayBuffer(file);
    }

    convertBtn.addEventListener('click', async ()=>{
      if(!lastHtml){ toast('Load a .docx first', 'warn'); return; }
      try{
        setStatus('Rendering PDF…');
        convertBtn.disabled = true;
        // Ensure white background for PDF capture
        const margin = Math.max(0, parseInt(marginEl.value||0,10));
        const opt = {
          margin: margin, // mm
          filename: (filenameEl.value || 'converted.pdf').replace(/\s+/g,'-'),
          pagebreak: { mode: ['avoid-all','css','legacy'] },
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2, useCORS: true, backgroundColor: '#ffffff' },
          jsPDF: { unit: 'mm', format: formatEl.value, orientation: orientationEl.value }
        };
        await html2pdf().set(opt).from(preview).save();
        setStatus('Done ✅');
      }catch(err){
        console.error(err);
        toast('Could not generate PDF', 'err');
        setStatus('Error');
      }finally{
        convertBtn.disabled = false;
      }
    });

    function setStatus(t){ statusEl.textContent = t }

    // Tiny toast helper
    function toast(msg, type='ok'){
      const div = document.createElement('div');
      div.textContent = msg;
      div.style.position='fixed'; div.style.left='50%'; div.style.top='20px'; div.style.transform='translateX(-50%)';
      div.style.padding='10px 14px'; div.style.borderRadius='12px'; div.style.zIndex='9999'; div.style.fontWeight='600';
      div.style.backdropFilter='blur(6px)'; div.style.border='1px solid rgba(255,255,255,.2)'; div.style.boxShadow='0 10px 30px rgba(0,0,0,.35)';
      div.style.background='rgba(15,23,42,.9)'; div.style.color='white';
      if(type==='warn') div.style.background='linear-gradient(180deg, rgba(245,158,11,.95), rgba(245,158,11,.8))';
      if(type==='err') div.style.background='linear-gradient(180deg, rgba(239,68,68,.95), rgba(239,68,68,.8))';
      if(type==='ok') div.style.background='linear-gradient(180deg, rgba(34,197,94,.95), rgba(34,197,94,.8))';
      document.body.appendChild(div); setTimeout(()=>{div.remove()}, 2400);
    }
  </script>
</body>
</html>
